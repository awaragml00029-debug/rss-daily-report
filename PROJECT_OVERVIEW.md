# 🎯 项目总览

## 项目名称
RSS Daily Report Generator - RSS 订阅日报生成器

## 功能简介
从 Google Sheets 自动读取 RSS 订阅数据，根据关键词筛选，生成格式化的每日和每月 Markdown 报告。

## 核心特性

### ✅ 已实现功能

1. **数据读取**
   - 从 Google Sheets 读取 RSS 数据
   - 支持多种日期格式自动解析
   - 基于抓取时间识别最新数据

2. **智能筛选**
   - 支持正则表达式关键词匹配
   - 自动模糊匹配（如"单细胞"匹配"单细胞测序"）
   - 支持排除关键词过滤

3. **报告生成**
   - 每日报告：当天所有匹配内容
   - 月度报告：整月数据汇总
   - 统计分析：关键词频次、日均数据等

4. **自动化运行**
   - GitHub Actions 定时任务
   - 每天 23:00 自动生成日报
   - 每月最后一天自动生成月报
   - 支持手动触发指定日期报告

5. **版本控制**
   - 所有报告自动提交到 Git
   - 完整的历史记录追踪

## 技术架构

```
┌─────────────────────────────────────────────────┐
│              Google Sheets (数据源)              │
│  抓取时间 | 属性 | 来源 | 分类 | 标题 | 链接... │
└────────────────────┬────────────────────────────┘
                     │
                     │ Google Sheets API
                     │ (Service Account)
                     ↓
┌─────────────────────────────────────────────────┐
│         GitHub Actions (定时任务触发)            │
│              Cron: 0 15 * * *                   │
└────────────────────┬────────────────────────────┘
                     │
                     │ Python Script
                     ↓
┌─────────────────────────────────────────────────┐
│          数据处理层 (generate_report.py)         │
│  ┌──────────────────────────────────────────┐  │
│  │  1. 连接 Google Sheets                   │  │
│  │  2. 读取所有数据                         │  │
│  │  3. 解析日期时间                         │  │
│  │  4. 筛选最新数据                         │  │
│  │  5. 关键词匹配（正则）                   │  │
│  │  6. 去重和排序                           │  │
│  │  7. 统计分析                             │  │
│  │  8. 生成 Markdown                        │  │
│  └──────────────────────────────────────────┘  │
└────────────────────┬────────────────────────────┘
                     │
                     │ File I/O
                     ↓
┌─────────────────────────────────────────────────┐
│            Markdown 报告 (输出)                  │
│  reports/                                       │
│  ├── 2025/                                      │
│  │   ├── 10/                                    │
│  │   │   ├── daily-2025-10-29.md               │
│  │   │   └── daily-2025-10-30.md               │
│  │   └── monthly-2025-10.md                    │
│  └── ...                                        │
└────────────────────┬────────────────────────────┘
                     │
                     │ Git Commit & Push
                     ↓
┌─────────────────────────────────────────────────┐
│           GitHub Repository (存储)               │
│              版本控制 & 在线查看                  │
└─────────────────────────────────────────────────┘
```

## 配置说明

### config.yaml 核心参数

```yaml
keywords:          # 筛选关键词（支持正则）
  - "肿瘤"
  - "测序"
  - "单细胞"

exclude_keywords:  # 排除关键词
  - "广告"
  - "推广"
```

### GitHub Secrets

```
GOOGLE_CREDENTIALS  # Google Service Account JSON
SHEET_ID           # Google Sheets ID
```

## 工作流程

### 每日报告生成流程

```
23:00 UTC+8 (定时触发)
    ↓
读取 Google Sheets 全部数据
    ↓
找到最新的抓取日期
    ↓
筛选该日期的所有数据
    ↓
应用关键词匹配规则
    ↓
按时间倒序排序
    ↓
生成 Markdown 报告
    ↓
保存到 reports/YYYY/MM/daily-YYYY-MM-DD.md
    ↓
Git commit & push
    ↓
完成 ✅
```

### 月度报告生成流程

```
每月最后一天 23:30 UTC+8
    ↓
读取当月所有日期的数据
    ↓
应用关键词筛选
    ↓
按日期分组统计
    ↓
生成月度汇总报告
    ↓
保存到 reports/YYYY/monthly-YYYY-MM.md
    ↓
Git commit & push
    ↓
完成 ✅
```

## 关键词匹配逻辑

### 模糊匹配实现

```python
# 关键词: "单细胞"
# 转换为正则: "单.*细.*胞"

匹配示例：
✅ 单细胞
✅ 单细胞测序
✅ 单细胞转录组
✅ 单个细胞分析
❌ 单核细胞（不匹配"细胞"）
```

### 优先级规则

1. **排除词优先**：先检查排除关键词
2. **多关键词**：只要匹配任一关键词即保留
3. **记录所有**：记录所有匹配的关键词用于统计

## 文件说明

| 文件 | 说明 |
|------|------|
| `config.yaml` | 配置文件（关键词、输出路径等） |
| `scripts/generate_report.py` | 主程序（核心逻辑） |
| `.github/workflows/generate-report.yml` | GitHub Actions 工作流 |
| `requirements.txt` | Python 依赖 |
| `test.py` | 本地测试脚本 |
| `README.md` | 项目文档 |
| `SETUP.md` | 快速设置指南 |
| `CHECKLIST.md` | 部署检查清单 |

## 扩展可能

### 未来可以添加的功能

1. **AI 摘要**
   - 使用 LLM 生成文章摘要
   - 智能分类和标签

2. **RSS 订阅**
   - 为生成的报告创建 RSS feed
   - 可以用 RSS 阅读器订阅

3. **邮件推送**
   - 每日报告自动发送到邮箱
   - 支持多人订阅

4. **Web 界面**
   - 使用 GitHub Pages 展示报告
   - 更友好的浏览体验

5. **数据分析**
   - 生成趋势图表
   - 热点话题追踪

6. **智能推荐**
   - 基于历史阅读推荐相关内容
   - 发现新的感兴趣话题

## 性能指标

- **处理速度**：200条数据 < 10秒
- **运行频率**：每天1次（日报）+ 每月1次（月报）
- **存储需求**：约 50KB/天，15MB/年
- **API 配额**：远低于 Google Sheets API 限制

## 依赖版本

```
Python: 3.10+
gspread: 5.12.0
oauth2client: 4.1.3
PyYAML: 6.0.1
python-dateutil: 2.8.2
```

## 许可证
MIT License

## 维护建议

1. **定期检查**：每周查看一次 Actions 运行状态
2. **关键词优化**：根据实际效果调整关键词列表
3. **存储清理**：建议每年归档一次旧报告
4. **备份**：定期备份 Google Sheets 数据

---

📅 最后更新：2025-10-29  
💡 如有问题，请查看 README.md 或提交 Issue
